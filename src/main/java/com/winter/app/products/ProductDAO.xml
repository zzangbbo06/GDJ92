<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <!-- namespace의 이름은 사용하려는 DAO의 풀패키지명과 동일하게 작성 -->
<mapper namespace="com.winter.app.products.ProductDAO">
	<resultMap type="ProductVO" id="detailResult">
		<!-- PK Mapping -->
			<id column="product_num" property="productNum"/>
		<!-- 그외 나머지 -->
			<result column="product_name" property="productName"/>
			<result column="product_contents" property="productContents"/>
			<result column="product_date" property="productDate"/>
			<result column="product_rate" property="productRate"/>
		<!-- 1:1 -->
			<association property="productKindVO" javaType="ProductKindVO">
				<id column="kind_num" property="kindNum"/>
				<result column="kind_name" property="kindName"/>
			</association>
	</resultMap>
	<!-- ID는 DAO의 메서드명과 동일하게 작성 -->
	
	<select id="list" resultType="ProductVO">
		SELECT * FROM PRODUCTS ORDER BY PRODUCT_NUM DESC;
	</select>
	
	<select id="detail" parameterType="ProductVO" resultMap="detailResult">
		SELECT * 
		FROM PRODUCTS P
			INNER JOIN 
			PRODUCTS_KIND K
			USING(KIND_NUM)
		WHERE P.PRODUCT_NUM=#{productNum}
	</select>
	
	<insert id="add" parameterType="ProductVO">
		INSERT INTO PRODUCTS
		VALUES(NULL, #{productName}, #{productContents}, now(), #{productRate}, #{kindNum})
	</insert>
	
	<update id="update" parameterType="ProductVO">
		UPDATE PRODUCTS
		SET
			PRODUCT_NAME = #{productName},
			PRODUCT_CONTENTS = #{productContents},
			PRODUCT_RATE = #{productRate},
			KIND_NUM = #{kindNum}
			WHERE PRODUCT_NUM = #{productNum}
	</update>
	
	
</mapper>